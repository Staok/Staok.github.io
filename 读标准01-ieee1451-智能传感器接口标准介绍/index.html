<!DOCTYPE html>
<html lang="">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>【读标准01】IEEE1451 智能传感器接口标准介绍 - 欢迎来到 瞰百Staok</title><meta name="Description" content="IEEE 1451 智能传感器接口标准介绍"><meta property="og:title" content="【读标准01】IEEE1451 智能传感器接口标准介绍" />
<meta property="og:description" content="IEEE 1451 智能传感器接口标准介绍" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://staok.github.io/%E8%AF%BB%E6%A0%87%E5%87%8601-ieee1451-%E6%99%BA%E8%83%BD%E4%BC%A0%E6%84%9F%E5%99%A8%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86%E4%BB%8B%E7%BB%8D/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-14T09:57:11+08:00" />
<meta property="article:modified_time" content="2021-07-16T18:27:39+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="【读标准01】IEEE1451 智能传感器接口标准介绍"/>
<meta name="twitter:description" content="IEEE 1451 智能传感器接口标准介绍"/>
<meta name="application-name" content="瞰百Staok">
<meta name="apple-mobile-web-app-title" content="瞰百Staok"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://staok.github.io/%E8%AF%BB%E6%A0%87%E5%87%8601-ieee1451-%E6%99%BA%E8%83%BD%E4%BC%A0%E6%84%9F%E5%99%A8%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86%E4%BB%8B%E7%BB%8D/" /><link rel="prev" href="https://staok.github.io/%E4%B8%BB%E7%BA%BF%E5%89%A7%E6%83%8501-arm-imx6ull%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" /><link rel="next" href="https://staok.github.io/%E5%BF%85%E5%85%88%E7%9C%8B%E4%B8%BB%E7%BA%BF%E5%89%A7%E6%83%85%E7%B3%BB%E5%88%97%E7%9A%84%E5%BE%AA%E5%BA%8F%E6%B8%90%E8%BF%9B%E7%9A%84%E6%9F%A5%E7%9C%8B%E9%A1%BA%E5%BA%8F/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "【读标准01】IEEE1451 智能传感器接口标准介绍",
        "inLanguage": "",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/staok.github.io\/%E8%AF%BB%E6%A0%87%E5%87%8601-ieee1451-%E6%99%BA%E8%83%BD%E4%BC%A0%E6%84%9F%E5%99%A8%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86%E4%BB%8B%E7%BB%8D\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/staok.github.io\/images\/Apple-Devices-Preview.png",
                            "width":  3200 ,
                            "height":  2048 
                        }],"genre": "posts","keywords": "IEEE 1451, 标准, 1451.0","wordcount":  11216 ,
        "url": "https:\/\/staok.github.io\/%E8%AF%BB%E6%A0%87%E5%87%8601-ieee1451-%E6%99%BA%E8%83%BD%E4%BC%A0%E6%84%9F%E5%99%A8%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86%E4%BB%8B%E7%BB%8D\/","datePublished": "2021-07-14T09:57:11+08:00","dateModified": "2021-07-16T18:27:39+08:00","publisher": {
            "@type": "Organization",
            "name": "Staok","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/staok.github.io\/images\/avatar.png",
                    "width":  404 ,
                    "height":  392 
                }},"author": {
                "@type": "Person",
                "name": "Staok"
            },"description": "IEEE 1451 智能传感器接口标准介绍"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="欢迎来到 瞰百Staok"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="欢迎来到 瞰百Staok"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">【读标准01】IEEE1451 智能传感器接口标准介绍</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/Staok" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Staok</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E8%AF%BB%E6%A0%87%E5%87%86/"><i class="far fa-folder fa-fw"></i>读标准</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-07-14">2021-07-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 11216 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 23 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#名词概念释义">名词/概念释义</a></li>
    <li><a href="#标准簇标准模型">标准簇/标准模型</a></li>
    <li><a href="#ncap-与-tim-通讯标准">NCAP 与 TIM 通讯标准</a>
      <ul>
        <li><a href="#通讯要素">通讯要素</a></li>
        <li><a href="#消息-的格式">消息 的格式</a>
          <ul>
            <li><a href="#命令消息">命令消息</a></li>
            <li><a href="#响应回复消息">响应/回复消息</a></li>
            <li><a href="#初始化完毕消息">初始化完毕消息</a></li>
          </ul>
        </li>
        <li><a href="#teds-的格式">TEDS 的格式</a>
          <ul>
            <li><a href="#meta-teds-格式">Meta-TEDS 格式</a></li>
            <li><a href="#transducerchannel-teds--格式">TransducerChannel TEDS  格式</a></li>
            <li><a href="#users-transducer-name-teds-格式">User’s Transducer Name TEDS 格式</a></li>
            <li><a href="#phy-teds-格式">PHY TEDS 格式</a></li>
            <li><a href="#teds-头">TEDS 头</a></li>
            <li><a href="#teds-属性">TEDS 属性</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#tim传感器-的状态图">TIM/传感器 的状态图</a></li>
    <li><a href="#14515-标准">1451.5 标准</a></li>
    <li><a href="#1451标准的局限性">1451标准的局限性</a></li>
    <li><a href="#参考--引用">参考 &amp; 引用</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="ieee-1451-智能传感器接口标准介绍">IEEE 1451 智能传感器接口标准介绍</h1>
<p>本文的 Github/Gitee 仓库：<a href="https://github.com/Staok/IEEE-1451-study" target="_blank" rel="noopener noreffer">Github仓库</a>，<a href="https://gitee.com/staok/IEEE-1451-study" target="_blank" rel="noopener noreffer">Gitee仓库</a>。</p>
<p>简单地说，IEEE 1451 标准是为了统一传感器的“接口”的标准，使其网络化、智能化和标准化，让相互不同的、陌生的传感器接入系统后可以“自发现”、“自识别”和“自组网”，并自动的开始进行数据和命令的上下传递，使传感器具有“即插即用”性、兼容性、互操作性与相互独立的解耦性（与 USB 等规范不同，此标准专门适应了 智能传感器的弱处理能力、低功耗、设备信息标准格式定义与传输、特有功能等独特性需求）。</p>
<p>记录经过阅读十几篇介绍文章、PPT和论文后的一点粗浅的感悟（发现）。标准的初心是大家都遵守的规范，用得越多越好，这样大家都能互识、互联和互通。本文中许多中文名词为作者本人翻译自英文源文，非官方。成文辛苦，图片高达 44 张。本文所用到的图片侵删。如有没看懂的地方可在评论区留言，帮助进行通俗化改进；如有错误也请直言不讳。</p>
<p>写标准就是画饼，画饼是快乐的，读起来就能感觉到；技术路线确定后，实现就是个稍显无趣的体力活了。</p>
<hr>
<h2 id="名词概念释义">名词/概念释义</h2>
<ol>
<li>
<p>一个传感器（或叫变送器，Transducer）主动或者被动的采集数据并以一定格式上传到中控参与控制或以图表形式显示，这是采集系统最简单的形式的表述。</p>
</li>
<li>
<p>一个传感器称得上为智能，有以下特征（标准 1451.0 定义的）：1、以数字的形式传递数据和命令，2、有统一的协议，3、提供触发、状态切换等可控制的功能；在作者看来，即传感器端加上一个微控制器（MCU，即漫威宇宙，啊不，即单片机）或者传感器端加上一个较复杂的 ASIC 专用逻辑芯片，实现以上功能，就算“智能”了。题外话，若更进一步，如果传感器的数据比较珍贵而且处理的计算量很大，传感器端可以上微处理器（MPU，或唤作 SoC），运行 Linux，该 SoC 带 GPU 等，再跑一些人工智能、深度学习算法，这算“边缘计算”的概念了。</p>
<p>下图为一种“智能传感器”的释义。</p>
<p><img src="assets/智能变送器具体.png" alt="智能变送器具体" style="zoom:67%;" /></p>
<p>更多的，智能传感器具有的特征如下（实际无必要全囊括）：</p>
<ul>
<li>自描述；自识别；</li>
<li>自诊断；自校准；</li>
<li>定位信息，时间信息；</li>
<li>数据聚合、处理和提取特征进行推理；</li>
<li>报警通知；</li>
<li>标准通讯接口和标准通讯协议。</li>
</ul>
<p>下图为工业现场背景下的一个智能传感器的示例（此图是通过无线的方式将数据发送出去），传感器会有成百上千个，而且类型也很多。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8.png"
        data-srcset="assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8.png, assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8.png 1.5x, assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8.png 2x"
        data-sizes="auto"
        alt="assets/智能传感器.png"
        title="智能传感器" /></p>
</li>
<li>
<p>现在 处理器平台 和 通讯/数据传输的接口 的繁多性，如下图。</p>
<p><img src="assets/现在处理器平台和通讯接口的繁多性.png" alt="现在处理器平台和通讯接口的繁多性" style="zoom:67%;" /></p>
</li>
<li>
<p>现在要很多个各式各样的智能传感器都可以连接到中控，要考虑两个方面：</p>
<ol>
<li>指定标准的数据和命令的上下传输的协议；</li>
<li>指定一个标准的传感器“身份证”，让一个传感器接入系统后先发送这个亮明自己身份的“身份证”，上面有我是谁（传感器 ID、类型等）、我有啥、我能干啥等等信息。</li>
</ol>
<p>第一个问题，标准的数据和命令上下传输协议，在1451标准中，数据和命令的传输都属于消息传输范畴，数据消息只有指定以字节形式高位先传（MSB），用户自定协议，命令消息有严格的发送和接收格式；</p>
<p>第二个中所讲的传感器的“身份证”，在1451标准中唤作 传感器电子数据表格（Transducer Electronic Data Sheet，TEDS）（源文翻译怪怪的），有严格的格式。这些协议或者叫格式的具体定义下文会引用标准源文讲到。下图为智能传感器带着TEDS的示例。</p>
<p><img src="assets/智能传感器带着TEDS.png" alt="智能传感器带着TEDS" style="zoom:70%;" /></p>
</li>
<li>
<p>连接传感器（也叫变送器）的模块，与传感器通讯拿到其数据，并以1451标准定义的协议上传这些数据的模块，这里叫做传感器接口模块（源文翻译）（Transducer Interface Module，TIM）。TEDS 存在于 TIM 中，实现自描述。</p>
</li>
<li>
<p>上文的传感器接口模块（TIM）通过有线或者无线的形式以1451标准定义的协议上传上来的数据会首先送到一个应用处理模块，该模块经过分析处理这些数据再通过网络发出去，这个应用处理模块当作中间件起到中间转发和管理的作用，在这里叫做联网应用处理器（源文翻译）（Network Capable Application Processor，NCAP）。NCAP 接收 TIM 发送上来的 TEDS 并作解析，实现自识别，还有控制/管理各个 TIM 的用处。</p>
</li>
</ol>
<h2 id="标准簇标准模型">标准簇/标准模型</h2>
<p>IEEE 1451 标准制定了 TEDS 的格式以及 联网应用处理器端（NCAP） 和 智能传感器端（TIM） 之间的通讯规范等。1451 协议簇：</p>
<p><img src="assets/1451协议簇.png" alt="1451协议簇" style="zoom: 67%;" /></p>
<p>下图可以让系统的结构清晰起来，一个 1451 模型的简略示意图，各个子标准分别描述了该模型各个部分的规范。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/1451%e7%ae%80%e7%95%a5%e6%a8%a1%e5%9e%8b.png"
        data-srcset="assets/1451%e7%ae%80%e7%95%a5%e6%a8%a1%e5%9e%8b.png, assets/1451%e7%ae%80%e7%95%a5%e6%a8%a1%e5%9e%8b.png 1.5x, assets/1451%e7%ae%80%e7%95%a5%e6%a8%a1%e5%9e%8b.png 2x"
        data-sizes="auto"
        alt="assets/1451简略模型.png"
        title="1451简略模型" /></p>
<p>简单描述各个子标准：</p>
<ul>
<li>
<p>1451.0 描述 NCAP 和 TIM 包含的必要和可选的功能、通讯协议（数据/命令 的 请求/响应 的协议）以及 TEDS 的格式等（Common functions, communication protocols, and TEDS formats），这个要在 TIM 和 NCAP 中实现，TIM 中主要实现 TEDS 用于自描述，NCAP 中主要实现 TEDS 的解析，这样才能发现新设备的接入，即自识别，另外还有管理和控制手底下这些 TIM 的实现，如通知/数据/命令的上下传输。</p>
</li>
<li>
<p>1451.2 描述 NCAP 和 TIM 之间以点对点（point-to-point）方式通讯（如串口的TTL/232/485、TII（该标准新定义的，类 SPI 的 10 线接口）、SPI 等）时候的相关标准，此时的 TIM 唤作 STIM（Smart Transducer Interface Module）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/1451.2%e6%a8%a1%e5%9e%8b.png"
        data-srcset="assets/1451.2%e6%a8%a1%e5%9e%8b.png, assets/1451.2%e6%a8%a1%e5%9e%8b.png 1.5x, assets/1451.2%e6%a8%a1%e5%9e%8b.png 2x"
        data-sizes="auto"
        alt="assets/1451.2模型.png"
        title="1451.2模型" /></p>
</li>
<li>
<p>1451.3 描述分布式多点总线（Multidrop）的总线方式通讯（各种 Bus，多个设备共享物理总线），此时的 TIM 唤作 TBIM（Transducer Bus Interface Modules）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/1451.3%e6%a8%a1%e5%9e%8b.png"
        data-srcset="assets/1451.3%e6%a8%a1%e5%9e%8b.png, assets/1451.3%e6%a8%a1%e5%9e%8b.png 1.5x, assets/1451.3%e6%a8%a1%e5%9e%8b.png 2x"
        data-sizes="auto"
        alt="assets/1451.3模型.png"
        title="1451.3模型" /></p>
</li>
<li>
<p>1451.4 描述数模混合接口的方式通讯，为传统的模拟传感器增加支持，传感器上电后先通过一根数字先发送 TEDS 给 NCAP，然后传感器用模拟线传递数据信息，此时与传统模拟传感器无异。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/1451.4%e6%a8%a1%e5%9e%8b.png"
        data-srcset="assets/1451.4%e6%a8%a1%e5%9e%8b.png, assets/1451.4%e6%a8%a1%e5%9e%8b.png 1.5x, assets/1451.4%e6%a8%a1%e5%9e%8b.png 2x"
        data-sizes="auto"
        alt="assets/1451.4模型.png"
        title="1451.4模型" /></p>
</li>
<li>
<p>1451.5 描述无线（Wireless）的方式通讯（如 WLAN、BT、ZigBee 等），此时的 TIM 唤作 WTIM（Wireless Transducer Interface Module）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/1451.5%e6%a8%a1%e5%9e%8b.png"
        data-srcset="assets/1451.5%e6%a8%a1%e5%9e%8b.png, assets/1451.5%e6%a8%a1%e5%9e%8b.png 1.5x, assets/1451.5%e6%a8%a1%e5%9e%8b.png 2x"
        data-sizes="auto"
        alt="assets/1451.5模型.png"
        title="1451.5模型" /></p>
</li>
<li>
<p>1451.6 描述在 CAN 总线物理层上利用 CANopen 协议进行通讯。</p>
</li>
<li>
<p>1451.7 描述利用 FRID 进行，扩展 RFID 系统的应用。</p>
</li>
<li>
<p>1451.1 描述 NCAP 与上面网络（Network）部分通讯的一种规范，是可选项，NCAP 入网的协议可以采用其它如 Web/HTTPS/MQTT 等。</p>
</li>
</ul>
<p>于是一张细节丰富一点的 1451 整体模型逐渐清晰，如下图。可以发现，1451.4 接口的智能传感器 通常挂在 TIM 之下。</p>
<p>![1451整体模型 1](assets/1451整体模型 1.png)</p>
<p>举一个例子，此时如果要根据这个图的架构搭建一个简易的测试用的 传感器采集并上传 的系统，如下图所示。橘色和绿色的部分是采用 1451.2 点对点的方式使 TIM 和 NCAP 通讯，这里使用 串口（UART），右边浅靛色部分是采用 1451.5 无线的方式实现 TIM 与 NCAP 通讯，多对一，各个 NCAP 上面都通过有线（网线）或者无线（WLAN）入网，下面的 TIM 可以实现灵活的接入自识别/自组网。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/%e4%b8%80%e4%b8%aa%e5%ae%9e%e4%be%8b%e7%a4%ba%e6%84%8f%e5%9b%be.png"
        data-srcset="assets/%e4%b8%80%e4%b8%aa%e5%ae%9e%e4%be%8b%e7%a4%ba%e6%84%8f%e5%9b%be.png, assets/%e4%b8%80%e4%b8%aa%e5%ae%9e%e4%be%8b%e7%a4%ba%e6%84%8f%e5%9b%be.png 1.5x, assets/%e4%b8%80%e4%b8%aa%e5%ae%9e%e4%be%8b%e7%a4%ba%e6%84%8f%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="assets/一个实例示意图.png"
        title="一个实例示意图" /></p>
<p>最后，1451 标准给出完整的整体模型，如下图。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/1451%e6%95%b4%e4%bd%93%e6%a8%a1%e5%9e%8b.png"
        data-srcset="assets/1451%e6%95%b4%e4%bd%93%e6%a8%a1%e5%9e%8b.png, assets/1451%e6%95%b4%e4%bd%93%e6%a8%a1%e5%9e%8b.png 1.5x, assets/1451%e6%95%b4%e4%bd%93%e6%a8%a1%e5%9e%8b.png 2x"
        data-sizes="auto"
        alt="assets/1451整体模型.png"
        title="1451整体模型" /></p>
<p><strong>可以看出 NCAP 与 TIM 之 间的接口被定义为 IEEE 1451.X 物理接口规范，根据不同的应用需求选择不同的子标准接口规范。1451.x 主要做数据中转，1451.0 主要做信息（message）和 TEDS 服务</strong>，上图中标注 Optional 的部分为可选的。</p>
<p>由标准给出的架构图可知，NCAP 和 TIM 之间通过 1451.x（x = 2、3、5、6 等）进行交互，在 1451.x（做数据中转） 之外再加一层 1451.0（做信息（message）和 TEDS 服务） 。若 1451.0 种提供的功能等足够系统，可以只用 1451.0，即直接用于 NCAP 和 TIM 之间的交互，如下图所示（引自论文《IEEE_1451网络化智能传感器接口技术_王石记》）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/1451.0%e6%9e%b6%e6%9e%84%e5%9b%be.png"
        data-srcset="assets/1451.0%e6%9e%b6%e6%9e%84%e5%9b%be.png, assets/1451.0%e6%9e%b6%e6%9e%84%e5%9b%be.png 1.5x, assets/1451.0%e6%9e%b6%e6%9e%84%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="assets/1451.0架构图.png"
        title="1451.0架构图" /></p>
<p>另外，一个 TIM 下面可以挂接多个 传感器，每一个传感器称为 一个传感器通道（Transducer Channel），一个 TIM 也可以挂接多个 执行器（Actuator，比如电机等），一个 TIM 下面也可以 连接多个 TIM，形成总分结构。</p>
<p>NCAP 对多个 TIM 的动态管理需要用户根据具体应用场景考虑，TIM 的接入、移出、命令/信息的收发等等。</p>
<h2 id="ncap-与-tim-通讯标准">NCAP 与 TIM 通讯标准</h2>
<p>**这里为 1451.0 标准，其他标准如 1451.2、1451.3、1451.4、1451.5 等 在 消息（message）和 TEDS 的定义上会有出入（各自有适应性改造），按需选择其中一个即可。**比如智能传感器系统中 NCAP 和 TIM 的通讯为 点对点的 有线的形式，则对于 消息（message）和 TEDS 的定义 看 1451.2 标准，如果为无线通讯形式，则对于 消息（message）和 TEDS 的定义 看 1451.5 标准。</p>
<h3 id="通讯要素">通讯要素</h3>
<p>模型 梳理好了，架构 在大脑中也形成了，就差它们中间流动的数字的通讯协议的规范。1451标准描述它们的通讯要素有以下方面：</p>
<ul>
<li>TEDS 的传递（递名片），TIM 自己的 TEDS 描述自己的信息（自描述），TIM 给 NCAP 发送自己的 TEDS（自识别），NCAP 可以发命令/数据来控制/读/写 TIM 的 TEDS。传感器自识别是 IEEE 1451 智能传感器的主要特点之一，TEDS 定义与配置是实现传感器自描述、自识别（即插即用）的核心技术。</li>
<li>数据的传递（干正事），以字节形式，高位先传（MSB），格式为用户自定（推荐使用“响应（Peply or Response）”的格式回传数据）；传输模式被定义为以下几种：1、NCAP 要时再给，2、TIM 缓存满时再给，3、TIM 固定周期性给，4、用户自定其它传输模式。</li>
<li>控制命令的传递（管一管），NCAP 和 TIM 可以相互发 控制命令消息（Command message）做请求（Request），接收方收到后必须予以响应（Response）。</li>
</ul>
<p>除了数据传递，TEDS 和控制命令的发送都需要等待 响应/回复/应答，若超过 1s 不响应则以 1s 周期循环发送和等待，直到收到正常响应，如果超过一定次数还未收到响应则断连。</p>
<p>1451.0 标准主要针对自描述名片和消息（TEDS and message）的具体规范，以下开始具体介绍。</p>
<h3 id="消息-的格式">消息 的格式</h3>
<p>TIM、NCAP 任一方接收到对方消息帧后须返回应答/响应/回复帧，若发送方在规定时间内没接收到对方确认应答帧则重新发送数据，直至发送成功或发送次数达到最大值。</p>
<p>刨除数据的传递，消息（message）分为以下三种类型：</p>
<ol>
<li>命令（command）；</li>
<li>响应/回复（Peply or Response）；</li>
<li>TIM 初始化完毕（TIM initiated）。</li>
</ol>
<h4 id="命令消息">命令消息</h4>
<p>命令消息（Command message）一般为 NCAP 向 目标 TIM 的特定 通道（Destination TransducerChannel）发送一帧数据来请求（Request）TEDS（就是问，你谁啊？） 或者控制命令（就是下达命令）。TIM 接收到后予以响应（Response），响应的格式详见“响应/回复消息”一节。</p>
<p>Command message 格式如下表所示。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/Command-message-%e6%a0%bc%e5%bc%8f.png"
        data-srcset="assets/Command-message-%e6%a0%bc%e5%bc%8f.png, assets/Command-message-%e6%a0%bc%e5%bc%8f.png 1.5x, assets/Command-message-%e6%a0%bc%e5%bc%8f.png 2x"
        data-sizes="auto"
        alt="assets/Command-message-格式.png"
        title="Command message 格式" /></p>
<p>具体释义如下：</p>
<ol>
<li>
<p>前两个字节（Dest Channel Number）指示 目标 TIM 的 目标 通道标号（具体如何分配标号 在 1451.0 标准的 “5.3 Addresses” 一节给出）；或者第一个字节表示目标 TIM 编号，第二个字节表示 传感器通道编号；</p>
</li>
<li>
<p>第三个字节（Command class）指示命令类别（Command class），具体值如下表，按需填入；</p>
<p>![命令类别（Command class）表](assets/命令类别（Command class）表.png)</p>
</li>
<li>
<p>第四个字节（Command function）指示具体的命令是什么，根据第三个字节的命令类别分为几大类。</p>
<ul>
<li>
<p>当第三个字节的命令类别（Command class）为 1，为通用命令（CommonCmd），则第四个字节填入下表中的标号以表示想要发送的具体命令。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/Common-commands.png"
        data-srcset="assets/Common-commands.png, assets/Common-commands.png 1.5x, assets/Common-commands.png 2x"
        data-sizes="auto"
        alt="assets/Common-commands.png"
        title="Common commands" /></p>
<ol>
<li>
<p>发送编号为 1 的 Query TEDS command（请求 TEDS 信息表命令） 命令，该命令带一个参数，即请求的 TEDS 的类型编号，详见下文 “TEDS 的格式” 一节的 Table-17。需要 TIM 响应/回应自己的 TEDS 的信息表，详见下表。响应/回复格式按照 “响应/回复消息” 一节描述的格式，下表为响应信息格式中 回复附带参数（Reply-dependent）部分的具体格式。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/Query-TEDS-respones.png"
        data-srcset="assets/Query-TEDS-respones.png, assets/Query-TEDS-respones.png 1.5x, assets/Query-TEDS-respones.png 2x"
        data-sizes="auto"
        alt="assets/Query-TEDS-respones.png"
        title="Query TEDS respones" /></p>
<p>该表具体释义如下：</p>
<ol>
<li>
<p>第一个字节 为自己的 TEDS 属性，详见 “TEDS 属性” 一节；</p>
</li>
<li>
<p>第二个字节 为 TEDS 状态，详见下表；</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/TEDS-status.png"
        data-srcset="assets/TEDS-status.png, assets/TEDS-status.png 1.5x, assets/TEDS-status.png 2x"
        data-sizes="auto"
        alt="assets/TEDS-status.png"
        title="TEDS status" /></p>
</li>
<li>
<p>第三、四、五、六个字节指示目前 TEDS 的字节数；</p>
</li>
<li>
<p>第七、八个字节为 TEDS 的校验值；</p>
</li>
<li>
<p>最后四个字节为 TEDS 的最大字节数。</p>
</li>
</ol>
</li>
<li>
<p>发送编号为 2 的 Read TEDS segment command（读 TEDS 命令）命令，参数为 Table-21 所示，如下图。需要 TIM 回应自己的 TEDS，具体格式为：按照 “响应/回复消息” 一节描述的格式，其第 4 个字节开始的 附带信息 的格式为 Table-22 定义，如下图。TEDS 的格式具体见 “TEDS 的格式” 一节。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/Read-TEDS-segment-%e5%91%bd%e4%bb%a4%e7%9a%84%e5%8f%82%e6%95%b0.png"
        data-srcset="assets/Read-TEDS-segment-%e5%91%bd%e4%bb%a4%e7%9a%84%e5%8f%82%e6%95%b0.png, assets/Read-TEDS-segment-%e5%91%bd%e4%bb%a4%e7%9a%84%e5%8f%82%e6%95%b0.png 1.5x, assets/Read-TEDS-segment-%e5%91%bd%e4%bb%a4%e7%9a%84%e5%8f%82%e6%95%b0.png 2x"
        data-sizes="auto"
        alt="assets/Read-TEDS-segment-命令的参数.png"
        title="Read TEDS segment 命令的参数" /></p>
<p>上表中， TEDSOffset 为 TIM 传回信息中 TEDS 数据开始的偏移量，如果 TIM 回应 纯的 TEDS 数据，那么该值为 0 即可。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/Read-TEDS-segment-%e5%91%bd%e4%bb%a4%e7%9a%84%e5%9b%9e%e5%ba%94.png"
        data-srcset="assets/Read-TEDS-segment-%e5%91%bd%e4%bb%a4%e7%9a%84%e5%9b%9e%e5%ba%94.png, assets/Read-TEDS-segment-%e5%91%bd%e4%bb%a4%e7%9a%84%e5%9b%9e%e5%ba%94.png 1.5x, assets/Read-TEDS-segment-%e5%91%bd%e4%bb%a4%e7%9a%84%e5%9b%9e%e5%ba%94.png 2x"
        data-sizes="auto"
        alt="assets/Read-TEDS-segment-命令的回应.png"
        title="Read TEDS segment 命令的回应" /></p>
</li>
<li>
<p>发送编号为 3 的 Write TEDS segment command（写 TEDS 命令） 命令，可以用于改写 目标 TIM 的 TEDS 的 某个部分。具体见标准 1451.0 的 7.1.1.3 一节。（太多了不想翻了，搞的那么繁杂）。</p>
</li>
<li>
<p>编号 4 的 Update TEDS command（更新 TEDS 命令），即使用 Write TEDS segment command（写 TEDS 命令）命令之后，再用该命令让 TIM 保存其刚接收到的新的 TEDS 到其非易失存储器（FLASH 或 EEPROM 等）内。命令参数为 TEDS 类型编号（Table-17），TIM 响应信息格式同Query TEDS command（请求 TEDS 信息表命令） 命令的回复格式。</p>
<p>下面不一个一个细说了。</p>
</li>
<li>
<p>编号 5 的 Run self-test command（运行自测命令）。</p>
</li>
<li>
<p>编号 6 的 Write service request mask（写 NCAP 请求目标地址的掩码）。</p>
</li>
<li>
<p>编号 7 的 Read service request mask（有写就有读&hellip;）。以下编号依次类推。</p>
</li>
<li>
<p>Read status-event register（读目标 TIM 或者 TIM 的传感器通道（Transducer Channel）的状态码）。</p>
</li>
<li>
<p>Read status-condition register。</p>
</li>
<li>
<p>Clear status-event register。</p>
</li>
<li>
<p>Write status-event protocol state。</p>
</li>
<li>
<p>Read status-event protocol state。</p>
</li>
<li>
<p>编号 128~255 的命令为用户保留，用户可自定义。</p>
</li>
</ol>
</li>
<li>
<p>前置定义，TIM 和传感器通道 的状态分类以及状态图定义，详见 “TIM/传感器 的状态图” 一节。当第三个字节的命令类别（Command class）为 2，即 传感器 空闲状态命令（XdcrIdle，Transducer idle state commands），该命令在 传感器 为 空闲状态（Idle）时才有效，其他状态无效。此时，第四个字节填入下表中的标号以表示想要发送的具体命令：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/Transducer-idle-state-commands.png"
        data-srcset="assets/Transducer-idle-state-commands.png, assets/Transducer-idle-state-commands.png 1.5x, assets/Transducer-idle-state-commands.png 2x"
        data-sizes="auto"
        alt="assets/Transducer-idle-state-commands.png"
        title="Transducer idle state commands" /></p>
<p>不一一详细介绍了，具体看 1451.0 标准源文的 7.1.2 一节。</p>
<ul>
<li>编号 1 为设置 TIM 的传感器通道的数量。</li>
<li>编号 2 为 设置 TIM 的某一个传感器通道能否在 free-running 状态下被设置为 pre-trigger 模式（关于 TIM 和 传感器通道的 状态和模式 定义详见 1451.0 标注源文的 5.10 一节）。</li>
<li>编号 3 This command assigns a TransducerChannel to an AddressGroup.</li>
<li>编号 4 设置 TIM 的某一个传感器通道的采集模式。</li>
<li>编号 5 设置 TIM 数据传输模式。</li>
<li>等等，太繁琐了。</li>
</ul>
</li>
<li>
<p>当第三个字节的命令类别（Command class）为 3，即 传感器 空闲状态命令（XdcrOperate，Transducer operating state commands），该命令在 传感器 为 工作状态（operational state）时才有效，其他状态无效。此时，第四个字节填入下表中的标号以表示想要发送的具体命令：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/Transducer-operating-state-commands.png"
        data-srcset="assets/Transducer-operating-state-commands.png, assets/Transducer-operating-state-commands.png 1.5x, assets/Transducer-operating-state-commands.png 2x"
        data-sizes="auto"
        alt="assets/Transducer-operating-state-commands.png"
        title="Transducer operating state commands" /></p>
<ol>
<li>编号 1 为 Read TransducerChannel data-set segment（读传感器通道数据集）命令，带一个命令参数为返回的数据集中读数据起始位置的偏移，TIM 回应数据以 “响应/回复消息” 一节描述的格式，响应/回复参数为 1451.0 标准 Table-32 指定。</li>
<li>后面略。</li>
</ol>
</li>
<li>
<p>当第三个字节的命令类别（Command class）为 4，即 传感器 空闲状态或工作状态命令（XdcrEither，Transducer either idle or operating state commands），此命令类下的具体命令见 1451.0 标注源文的 Table-34。</p>
</li>
<li>
<p>当第三个字节的命令类别（Command class）为 5，即 TIM 睡眠状态命令（TIM sleep state commands），该命令只在 TIM 睡眠状态下有效，此命令类下的具体命令见 1451.0 标注源文的 Table-35，用于唤醒，目前只此一个命令，其他均作保留。</p>
</li>
<li>
<p>当第三个字节的命令类别（Command class）为 6，即 TIM 激活状态命令（TIM active state commands），该命令只在 TIM 激活状态下有效，此命令类下的具体命令见 1451.0 标注源文的 Table-36。</p>
</li>
<li>
<p>当第三个字节的命令类别（Command class）为 7，即 TIM 任何状态命令（TIM any state commands），此命令类下的具体命令见 1451.0 标注源文的 Table-37，用于复位 TIM，目前只此一个命令，其他均作保留。</p>
</li>
</ul>
</li>
<li>
<p>第五、六个字节（Length）指示 附带的命令参数的字节数，接收方可据此判断何时接收完毕从而得到完整数据；</p>
</li>
<li>
<p>往后（Command dependent）为根据具体的附带的命令的参数。</p>
</li>
</ol>
<h4 id="响应回复消息">响应/回复消息</h4>
<p>一方接收到消息（Message）后予以响应/回应/回复（Peply or Response），其具体的的消息格式如下表所示。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/Reply-message.png"
        data-srcset="assets/Reply-message.png, assets/Reply-message.png 1.5x, assets/Reply-message.png 2x"
        data-sizes="auto"
        alt="assets/Reply-message.png"
        title="Reply message" /></p>
<p>具体释义如下：</p>
<ol>
<li>第一个字节（Flag）：0 表示失败，其它值 表示成功；</li>
<li>第二、三个字节（Length）：指示 Reply-dependent 部分的字节数，接收方可据此判断何时接收完毕从而得到完整数据；</li>
<li>往后为 Reply-dependent 内容，根据收到的特定命令回应相应的信息。</li>
</ol>
<h4 id="初始化完毕消息">初始化完毕消息</h4>
<p>TIM 初始化完毕后给 NCAP 发送一个 初始化完毕信息（TIM initiated message），其具体的的消息格式如下表所示。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/TIM-initiated-message.png"
        data-srcset="assets/TIM-initiated-message.png, assets/TIM-initiated-message.png 1.5x, assets/TIM-initiated-message.png 2x"
        data-sizes="auto"
        alt="assets/TIM-initiated-message.png"
        title="TIM initiated message" /></p>
<p>具体释义如下：</p>
<ol>
<li>前两个字节指示 本 TIM 的哪个通道 在发 此信息，即指示哪个通道初始化完毕了；</li>
<li>其他格式 同 “命令消息”，具体详看同名小节。</li>
</ol>
<h3 id="teds-的格式">TEDS 的格式</h3>
<blockquote>
<p>TEDS 包含一个仪器设备或测量系统，可对传感器进行识别、校正、连接及传感器数据信息的正确使用。具体信息有：厂商信息、模块编号、版本信息、产品序列号、灵敏度、测量范围、电气输出范围、功率要求、物理单位、校准信息、维护信息、位置信息以及用户数据等。</p>
<p>TIM 一旦上电或接受了 请求 TEDS 的命令，TEDS 信息就上传到 NCAP。TEDS 简化了传感器的安装/部署，一个被损坏的传感器可以直接被替换而不需要更改任何设置。</p>
</blockquote>
<p>TEDS 的所有类型如下图，第三列是该类型的名称。第一列的代号为 10 进制表示。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/TEDS%e7%9a%84%e6%89%80%e6%9c%89%e7%b1%bb%e5%9e%8b.png"
        data-srcset="assets/TEDS%e7%9a%84%e6%89%80%e6%9c%89%e7%b1%bb%e5%9e%8b.png, assets/TEDS%e7%9a%84%e6%89%80%e6%9c%89%e7%b1%bb%e5%9e%8b.png 1.5x, assets/TEDS%e7%9a%84%e6%89%80%e6%9c%89%e7%b1%bb%e5%9e%8b.png 2x"
        data-sizes="auto"
        alt="assets/TEDS的所有类型.png"
        title="TEDS的所有类型" /></p>
<p>一个 TIM 必要有的四个 TEDS 类型如下，其他 TEDS 为可选。</p>
<ul>
<li>Meta-TEDS（描述所在 TIM 的基本信息、，传感器通道数、分组情况，详见 1451.0 标准的 8.4 小节）；</li>
<li>TransducerChannel TEDS（描述 TIM 中特定传感器通道的详细信息，比如物理上实际的采集量、被控量，工作模式等，详见 1451.0 标准的 8.5 小节）；</li>
<li>User’s Transducer Name TEDS（存储所在智能传感器的名称用于系统识别，用于，详见 1451.0 标准的 5.5.1.3 小节和 8.11 小节）；</li>
<li>PHY TEDS（描述 TIM 与 NCAP 之间的物理连接的媒介，格式无标准定义，可用户自定）。</li>
</ul>
<p>所有 TEDS 类型的格式如下（General format for TEDS）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/General-format-for-TEDS.png"
        data-srcset="assets/General-format-for-TEDS.png, assets/General-format-for-TEDS.png 1.5x, assets/General-format-for-TEDS.png 2x"
        data-sizes="auto"
        alt="assets/General-format-for-TEDS.png"
        title="General-format-for-TEDS.png" /></p>
<p>如上图所示，一帧数据的构建：</p>
<ol>
<li>
<p>TED 长度（TED Length），包括 DATA BLOCK 和 CHECKSUM，字节为单位 （占 4 个字节）；</p>
</li>
<li>
<p>数据区（DATA BLOCK）：</p>
<ol>
<li>
<p>第一个域类（Field type）（占 1 个字节）；</p>
</li>
<li>
<p>第一个域类的 值的长度（Length of Value），字节为单位（占一个字节）；</p>
</li>
<li>
<p>第一个域类的值（Value）（占 值的长度 个字节）；</p>
</li>
<li>
<p>第二个域类（占 1 个字节）；</p>
</li>
<li>
<p>第二个域类的 值的长度，字节为单位（占一个字节）；</p>
</li>
<li>
<p>第二个域类的值（占 值的长度 个字节）；</p>
<p>&hellip;</p>
</li>
<li>
<p>以此类推。</p>
</li>
</ol>
</li>
<li>
<p>校验值（CHECKSUM），从 TED Length 到 DATA BLOCK 的最后一个字节加和，再用 0xFFF 减去该加和值（占两个字节）。</p>
</li>
</ol>
<p>TEDS 的一些注意的点：</p>
<ul>
<li>TEDS 有 实TEDS 和 虚TEDS 之分，对于那些不能包含非易失存储器器件来保存 TEDS 的 TIM 就是用 虚TEDS，虚TEDS 保存在某个网络节点上，NCAP 索要 TEDS 的时候由该节点提供 TIM 的 TEDS ，实 TEDS 即 TEDS 信息真实的保存在 TIM 内部的非易失存储器。</li>
<li>TEDS 的内容 在 TIM 执行器件可以根据传感器通道等的变化进行改动，或者接收到 NCAP 的改动 TEDS 的控制命令消息进行改动。</li>
<li>可以根据应用场景和开发限制来适当删减 TEDS 中一些冗长繁杂的格式。</li>
</ul>
<h4 id="meta-teds-格式">Meta-TEDS 格式</h4>
<p>描述所在 TIM 的基本信息、，传感器通道数、分组情况，详见 1451.0 标准的 8.4 小节。</p>
<p>该 TEDS 可以如何访问到：The Meta-TEDS is accessed using a Query TEDS command, a Read TEDS segment command, a write TEDS segment command, or an Update TEDS command.从 Table-17 可知该 TEDS 代号 01（10 进制）。该表的第一列 域类 号均为 10 进制表示。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/Meta-TEDS.png"
        data-srcset="assets/Meta-TEDS.png, assets/Meta-TEDS.png 1.5x, assets/Meta-TEDS.png 2x"
        data-sizes="auto"
        alt="assets/Meta-TEDS.png"
        title="Meta-TEDS" /></p>
<p>上表的各个域类不必全部给出，标好域类好就行。其具体说明如下：</p>
<ul>
<li>
<p>开头为 TED 长度（TED Length），包括 DATA BLOCK 和 CHECKSUM，字节为单位，占 4 个字节；</p>
</li>
<li>
<p>数据区（DATA BLOCK）的第一个域类为 TEDSID，即 TEDS identification header，详见 本文 “TEDS 头” 一节；</p>
</li>
<li>
<p>第二个域类 UUID，全局独特身份码（名片上的大名），举例（16 进制）：<code>04 0a 8d 4d 9d a6 52 81 f7 00 00 00</code>，释义如下。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/UUID%e4%b8%be%e4%be%8b.png"
        data-srcset="assets/UUID%e4%b8%be%e4%be%8b.png, assets/UUID%e4%b8%be%e4%be%8b.png 1.5x, assets/UUID%e4%b8%be%e4%be%8b.png 2x"
        data-sizes="auto"
        alt="assets/UUID举例.png"
        title="UUID举例" /></p>
<p>UUID 的定义如下。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/UUI%e7%9a%84%e5%ae%9a%e4%b9%89.png"
        data-srcset="assets/UUI%e7%9a%84%e5%ae%9a%e4%b9%89.png, assets/UUI%e7%9a%84%e5%ae%9a%e4%b9%89.png 1.5x, assets/UUI%e7%9a%84%e5%ae%9a%e4%b9%89.png 2x"
        data-sizes="auto"
        alt="assets/UUI的定义.png"
        title="UUI的定义" /></p>
</li>
<li>
<p>紧跟着三个域类分别是 操作超时时间、低速访问超时时间和自测试时间，举例如下。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/%e4%b8%89%e4%b8%aa%e5%9f%9f%e7%b1%bb.png"
        data-srcset="assets/%e4%b8%89%e4%b8%aa%e5%9f%9f%e7%b1%bb.png, assets/%e4%b8%89%e4%b8%aa%e5%9f%9f%e7%b1%bb.png 1.5x, assets/%e4%b8%89%e4%b8%aa%e5%9f%9f%e7%b1%bb.png 2x"
        data-sizes="auto"
        alt="assets/三个域类.png"
        title="操作超时时间、低速访问超时时间和自测试时间" /></p>
<p>Float32 占用四个字节，具体编码描述： A single-precision real number is a 32 bit binary sequence that encodes real numbers as specified in IEEE Std 754-1985.</p>
</li>
<li>
<p>来到域类13，MaxChan，本智能传感器 TIM 下边连着几个 传感器通道（“传感器通道（Transducer Channel）” 这里英文缩写表示为 TCH）（比如采集三路模拟量），举例（16 进制）：<code>0d 02 00 03</code>，表示本 TIM 有 三个传感器通道。</p>
</li>
<li>
<p>其他域类&hellip;</p>
</li>
<li>
<p>最后两个字节做校验位，从 TED Length（最开头） 到 DATA BLOCK 的最后一个字节（本域类的上一个字节） 的加和，再用 0xFFF 减去该加和值。</p>
</li>
</ul>
<p>上面的进行组合，这就是一帧 Meta-TEDS。</p>
<p>再举一个具体的例子（已经保姆级详尽了），如下图所示一个完整 Meta-TEDS。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/%e4%b8%80%e4%b8%aaMeta-TEDS%e5%ae%8c%e6%95%b4%e4%be%8b%e5%ad%90.png"
        data-srcset="assets/%e4%b8%80%e4%b8%aaMeta-TEDS%e5%ae%8c%e6%95%b4%e4%be%8b%e5%ad%90.png, assets/%e4%b8%80%e4%b8%aaMeta-TEDS%e5%ae%8c%e6%95%b4%e4%be%8b%e5%ad%90.png 1.5x, assets/%e4%b8%80%e4%b8%aaMeta-TEDS%e5%ae%8c%e6%95%b4%e4%be%8b%e5%ad%90.png 2x"
        data-sizes="auto"
        alt="assets/一个Meta-TEDS完整例子.png"
        title="一个Meta-TEDS完整例子" /></p>
<h4 id="transducerchannel-teds--格式">TransducerChannel TEDS  格式</h4>
<p>该 TEDS 是为了确保 TIM 的所有 传感器通道（TCH）有必要信息从而可以被寻址和被操作。该 TEDS 描述 TIM 中特定传感器通道的详细信息，比如物理上实际的采集量、被控量，工作模式等，详见 1451.0 标准的 8.5 小节。</p>
<p>该 TEDS 可以如何访问到：The TransducerChannel TEDS is accessed using a Query TEDS command, a Read TEDS segment command, a write TEDS segment command, or an Update TEDS command.从 Table-17 可知该 TEDS 代号 03（10 进制）。该表的第一列 域类 号均为 10 进制表示。域类3 TEDSID 详见 “TEDS 头” 一节。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/TransducerChannel-TEDS.png"
        data-srcset="assets/TransducerChannel-TEDS.png, assets/TransducerChannel-TEDS.png 1.5x, assets/TransducerChannel-TEDS.png 2x"
        data-sizes="auto"
        alt="assets/TransducerChannel-TEDS.png"
        title="TransducerChannel-TEDS" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/TransducerChannel-TEDS-%e7%bb%ad.png"
        data-srcset="assets/TransducerChannel-TEDS-%e7%bb%ad.png, assets/TransducerChannel-TEDS-%e7%bb%ad.png 1.5x, assets/TransducerChannel-TEDS-%e7%bb%ad.png 2x"
        data-sizes="auto"
        alt="assets/TransducerChannel-TEDS-续.png"
        title="TransducerChannel-TEDS-续" /></p>
<p>信息特别多了，以上每项的具体说明见 1451.0 标准的 “8.5.2 Data block” 章节。</p>
<h4 id="users-transducer-name-teds-格式">User’s Transducer Name TEDS 格式</h4>
<p>存储所在智能传感器的名称用于系统识别，用于，详见 1451.0 标准的 5.5.1.3 小节和 8.11 小节。</p>
<p>The User’s Transducer Name TEDS may be associated with the TIM or a TransducerChannel. It is accessed using a Query TEDS command, a Read TEDS segment command, a write TEDS segment command, or an Update TEDS command.从 Table-17 可知该 TEDS 代号 12。该表的第一列 域类 号均为 10 进制表示。域类3 TEDSID 详见 “TEDS 头” 一节。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/User%27s-Transducer-Name-TEDS.png"
        data-srcset="assets/User%27s-Transducer-Name-TEDS.png, assets/User%27s-Transducer-Name-TEDS.png 1.5x, assets/User%27s-Transducer-Name-TEDS.png 2x"
        data-sizes="auto"
        alt="assets/User&#39;s-Transducer-Name-TEDS.png"
        title="User’s Transducer Name TEDS" /></p>
<p>上表中域类4，即 format 详见下表（下表中 Field Name 一栏为 16 进制的 10，即 十进制的 4）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/User%27s-Transducer-Name-TEDS-format.png"
        data-srcset="assets/User%27s-Transducer-Name-TEDS-format.png, assets/User%27s-Transducer-Name-TEDS-format.png 1.5x, assets/User%27s-Transducer-Name-TEDS-format.png 2x"
        data-sizes="auto"
        alt="assets/User&#39;s-Transducer-Name-TEDS-format.png"
        title="User&amp;rsquo;s Transducer Name TEDS format" /></p>
<p>域类5，即 content，详见下表，内容用户自定， TIM 的名字，规范根据 域类 4 的 format 的值（0 为用户自定，1 为按照 标准中 8.9 Text-based TEDS 的规范来（又是一大堆））。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/User%27s-Transducer-Name-TEDS-content.png"
        data-srcset="assets/User%27s-Transducer-Name-TEDS-content.png, assets/User%27s-Transducer-Name-TEDS-content.png 1.5x, assets/User%27s-Transducer-Name-TEDS-content.png 2x"
        data-sizes="auto"
        alt="assets/User&#39;s-Transducer-Name-TEDS-content.png"
        title="User&amp;rsquo;s Transducer Name TEDS content" /></p>
<h4 id="phy-teds-格式">PHY TEDS 格式</h4>
<p>1451.0 的一页源文。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/PHY-TEDS.png"
        data-srcset="assets/PHY-TEDS.png, assets/PHY-TEDS.png 1.5x, assets/PHY-TEDS.png 2x"
        data-sizes="auto"
        alt="assets/PHY-TEDS.png"
        title="PHY TEDS" /></p>
<p>PHY TEDS 的具体格式定义在 1451.x（x = 2,3,4,5&hellip;）标准里，比如对于 1451.5 无线方式通讯，PHY TEDS 格式定义在其 5.3 一节。</p>
<h4 id="teds-头">TEDS 头</h4>
<p>即 TEDS identification header，这是一个域类，定位于 Meta-TEDS 格式表中的 域类3 中，具体定义详见 1451.0 标准 8.3 小节，格式如下表所示。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/TEDS-identification-header.png"
        data-srcset="assets/TEDS-identification-header.png, assets/TEDS-identification-header.png 1.5x, assets/TEDS-identification-header.png 2x"
        data-sizes="auto"
        alt="assets/TEDS-identification-header.png"
        title="TEDS identification header" /></p>
<p>上表具体说明如下：</p>
<ul>
<li>
<p>前面三个一般不变，为 <code>03 04 00</code>；需要说明，Family 域的值随着 使用 1451.x（x = 0,2,3,4,5&hellip;）标准而变，比如使用 1451.5，Family 域的值变为 05；</p>
</li>
<li>
<p>第四个域（Class 那里）为当前 TEDS 的类型编号，其具体值见上面 “TEDS 的所有类型” 的表（Table 17）；</p>
</li>
<li>
<p>第五个域（Version 那里）的具体值见下表（Table 42）；</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/TEDS%e5%a4%b4%e4%b8%ad%e7%9a%84%e7%89%88%e6%9c%ac%e5%ae%9a%e4%b9%89.png"
        data-srcset="assets/TEDS%e5%a4%b4%e4%b8%ad%e7%9a%84%e7%89%88%e6%9c%ac%e5%ae%9a%e4%b9%89.png, assets/TEDS%e5%a4%b4%e4%b8%ad%e7%9a%84%e7%89%88%e6%9c%ac%e5%ae%9a%e4%b9%89.png 1.5x, assets/TEDS%e5%a4%b4%e4%b8%ad%e7%9a%84%e7%89%88%e6%9c%ac%e5%ae%9a%e4%b9%89.png 2x"
        data-sizes="auto"
        alt="assets/TEDS头中的版本定义.png"
        title="TEDS 头中的版本定义" /></p>
</li>
<li>
<p>第六个域（Tuple Length 那里）的具体值，即上面所说的“数据区（DATA BLOCK）”里面的“第 x 个域类的 值的长度（Length of Value）”这个域类所占几个字节，一般为 1。</p>
</li>
</ul>
<p>则 TEDS identification header 这个域类的最终合成如右（举例，十六进制）：<code>03 04 00 01 01 01</code>，具体释义如下。</p>
<p><img src="assets/TEDS头的例子.png" alt="TEDS头的例子" style="zoom: 67%;" /></p>
<h4 id="teds-属性">TEDS 属性</h4>
<p>每个 TEDS 都有属性，在 请求 TEDS 命令（Query TEDS command）之后 TIM 响应 TEDS 时带着 该 TEDS 的属性信息。</p>
<p>TEDS 的属性可以设置为 只读，这样 NCAP 的修改 TEDS 的命令不会起作用。源文：TEDS may be implemented as a read-only TEDS to prevent changes from being made in the field because changes could cause unpredictable behavior. If it is implemented as a read-only TEDS, the TransducerChannel write TEDS segment and TransducerChannel Update TEDS commands shall not apply.</p>
<p>TEDS 属性具体定义如下表所示。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/TEDS-attr.png"
        data-srcset="assets/TEDS-attr.png, assets/TEDS-attr.png 1.5x, assets/TEDS-attr.png 2x"
        data-sizes="auto"
        alt="assets/TEDS-attr.png"
        title="TEDS attr" /></p>
<h2 id="tim传感器-的状态图">TIM/传感器 的状态图</h2>
<p>根据 1451.0，TIM 的状态分为两个部分，TIM 自己的状态以及 TIM 下面接的每一个传感器通道的模式状态，TIM 讲模式，传感器讲模式。</p>
<p>智能传感器的 TIM 状态转换图。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8%e7%9a%84TIM%e7%8a%b6%e6%80%81%e5%9b%be.png"
        data-srcset="assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8%e7%9a%84TIM%e7%8a%b6%e6%80%81%e5%9b%be.png, assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8%e7%9a%84TIM%e7%8a%b6%e6%80%81%e5%9b%be.png 1.5x, assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8%e7%9a%84TIM%e7%8a%b6%e6%80%81%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="assets/智能传感器的TIM状态图.png"
        title="智能传感器的TIM状态图" /></p>
<p>智能传感器 TIM 每一个传感器通道（TCH）的状态转换图（模式转换图）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8%e6%af%8f%e4%b8%80%e4%b8%aa%e9%80%9a%e9%81%93%e7%9a%84%e7%8a%b6%e6%80%81%e5%9b%be.png"
        data-srcset="assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8%e6%af%8f%e4%b8%80%e4%b8%aa%e9%80%9a%e9%81%93%e7%9a%84%e7%8a%b6%e6%80%81%e5%9b%be.png, assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8%e6%af%8f%e4%b8%80%e4%b8%aa%e9%80%9a%e9%81%93%e7%9a%84%e7%8a%b6%e6%80%81%e5%9b%be.png 1.5x, assets/%e6%99%ba%e8%83%bd%e4%bc%a0%e6%84%9f%e5%99%a8%e6%af%8f%e4%b8%80%e4%b8%aa%e9%80%9a%e9%81%93%e7%9a%84%e7%8a%b6%e6%80%81%e5%9b%be.png 2x"
        data-sizes="auto"
        alt="assets/智能传感器每一个通道的状态图.png"
        title="智能传感器每一个通道的状态图" /></p>
<h2 id="14515-标准">1451.5 标准</h2>
<p>1451.5 标准中对于 1451.0 标准的一些新增/兼容部分，参考于 1451.5 标准源文。</p>
<p>1451.5 标准的变化之处举例：</p>
<ul>
<li>TIM 与 NCAP 的连接拓扑关系有新定义（5.1、5.2 小节）；</li>
<li>NCAP 和 TIM 状态图新定义（5.4、5.5 小节）；</li>
<li>服务质量定义（5.6 小节）；</li>
<li>错误代号定义（5.7 小节）；</li>
<li>message 不变；</li>
<li>TEDS 除了 PHY TEDS，其他一样（5.3 小节）；</li>
<li>WLAN 章节的一些特别定义（第 9 章）。</li>
</ul>
<p>关于具体的 1451.5 标准的情况的介绍会在下一篇【读标准02】文章。</p>
<h2 id="1451标准的局限性">1451标准的局限性</h2>
<p>以下记录一些推广上的局限性 和 一些疑问。</p>
<ol>
<li>把网络化智能传感器系统分为 NCAP 和 TIM 两个模块，而这两个模块都需要有微控制器（或微处理器），增加上手门槛和使用的复杂性。</li>
<li>1451.x 标准 只能放在一起使用，与现有其他标准或者协议差异巨大，需要全新的重新开发。</li>
<li>一个 NCAP 连接多个 TIM ，NCAP 该如何区分不同的 TIM，1451.5 定义吗？，还是用户自定？</li>
<li>连续发了三个命令，陆续收到三个响应，三个收到的响应如何与三个命令一一对应起来？作者在此认为，响应/回复信息中的回复附带参数部分（Reply-dependent）首先填入接收到的命令的类（class）和具体命令这两个编号，然后才是真正的附带参数，这样 NCAP 可以区分该 回复是针对哪个命令的，NCAP 可以据此差异性解析，提高交互并发性，而不用发出一个命令后只能先等。不过标准也许有对这一块的定义，可能源文几百页太长了作者没注意到。</li>
<li>TEDS 在尽量包含所有传感器类型的描述信息，但不可能穷举所有传感器类型；对于应用层没有对数据格式做规范。简而言之，本文作者认为综合性、一般性模型的目标不算尽善尽美的达到。</li>
<li>与一般标准的一样，体系庞大，内容非常复杂 ，人们理解起来非常费时费力；如今嵌入式处理器应用越来越广，低成本和低功耗的考虑越来越多，因此人们可能只能执行标准的一部分。</li>
<li>制定标准时不容易或者没有处理好与已有标准协议的关系。（6、7 条引自论文《海洋观测网络化智能接口标准的研究_张帅》）</li>
<li></li>
</ol>
<h2 id="参考--引用">参考 &amp; 引用</h2>
<p>[0] IEEE 1451 协议培训，<a href="https://wenku.baidu.com/view/fab6e7c0bbf67c1cfad6195f312b3169a451ead7.html" target="_blank" rel="noopener noreffer">IEEE-1451-介绍 - 百度文库 (baidu.com)</a>，<a href="https://wenku.baidu.com/view/d1270a2ecf1755270722192e453610661fd95a55.html" target="_blank" rel="noopener noreffer">IEEE 1451 介绍ppt课件 - 百度文库 (baidu.com)</a>，<a href="https://www.renrendoc.com/paper/208306691.html" target="_blank" rel="noopener noreffer">IEEE 1451 介绍课件 (renrendoc.com)</a>。</p>
<p>[1] 孔勇,杨志强,张溪溪,杨吉宇,李继明,程学珍.基于IEEE1451标准的称重传感器实验系统设计ADXL355加速度计在强振动环境中的应用[J].电子测试,2020(15):11-13+42.DOI:10.16520/j.cnki.1000-8519.2020.15.003.</p>
<p>[2] 解宇. 海洋仪器网络化平台智能船载终端研发[D].济南大学,2019.DOI:10.27166/d.cnki.gsdcc.2019.000446.</p>
<p>[3] 杨吉语. 基于IEEE1451.5标准网络传感器的研发[D].山东科技大学,2018.DOI:10.27275/d.cnki.gsdku.2018.000570.</p>
<p>[4] 陈耿新,黄锦胜.基于IEEE 1451.5的高精度智能称重传感器系统[J].自动化与信息工程,2017,38(05):5-11.</p>
<p>[5] 赵常. 基于IEEE1451标准的加速度智能传感器的研究[D].沈阳理工大学,2016.</p>
<p>[6] 陶星珍,蒋廷彪,崔更申.基于IEEE 1451.5标准的物联网体系结构设计[J].计算机测量与控制,2014,22(09):2960-2961+2966.DOI:10.16526/j.cnki.11-4762/tp.2014.09.039.</p>
<p>[7] 朱志伟.遵循IEEE1451标准的传感器即插即用研究[J].单片机与嵌入式系统应用,2014,14(09):3-6.</p>
<p>[8] 张小廷. 基于IEEE1451标准的无线智能传感网的设计与实现[D].哈尔滨工业大学,2014.</p>
<p>[9] 张帅,张锁平,齐占辉.海洋观测网络化智能接口标准的研究[J].电子设计工程,2013,21(09):183-187.DOI:10.14022/j.cnki.dzsjgc.2013.09.003.</p>
<p>[10] 王石记,周庆飞,安佰岳.IEEE 1451网络化智能传感器接口技术[J].计算机测量与控制,2012,20(10):2600-2602+2616.DOI:10.16526/j.cnki.11-4762/tp.2012.10.076.</p>
<p>[11] 郑培亮. 基于ARM的IEEE 1451智能称重传感器设计[D].华南理工大学,2011.</p>
<p>[12] 张韵. 基于IEEE1451标准中间件的研究和实现[D].大连理工大学,2007.</p>
<p>[13] 黄永忠,李正晓.IEEE 1451标准族智能传感器技术发展浅析[J].仪器仪表标准化与计量,2005(04):24-27.</p>
<p>[14] 童利标,徐科军,梅涛.IEEE1451网络化智能传感器标准的发展及应用探讨[J].传感器世界,2002(06):25-32.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-07-16</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/%E8%AF%BB%E6%A0%87%E5%87%8601-ieee1451-%E6%99%BA%E8%83%BD%E4%BC%A0%E6%84%9F%E5%99%A8%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86%E4%BB%8B%E7%BB%8D/index.md" target="_blank">阅读原始文档</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://staok.github.io/%E8%AF%BB%E6%A0%87%E5%87%8601-ieee1451-%E6%99%BA%E8%83%BD%E4%BC%A0%E6%84%9F%E5%99%A8%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86%E4%BB%8B%E7%BB%8D/" data-title="【读标准01】IEEE1451 智能传感器接口标准介绍" data-hashtags="IEEE 1451,标准,1451.0"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://staok.github.io/%E8%AF%BB%E6%A0%87%E5%87%8601-ieee1451-%E6%99%BA%E8%83%BD%E4%BC%A0%E6%84%9F%E5%99%A8%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86%E4%BB%8B%E7%BB%8D/" data-hashtag="IEEE 1451"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Linkedin" data-sharer="linkedin" data-url="https://staok.github.io/%E8%AF%BB%E6%A0%87%E5%87%8601-ieee1451-%E6%99%BA%E8%83%BD%E4%BC%A0%E6%84%9F%E5%99%A8%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86%E4%BB%8B%E7%BB%8D/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://staok.github.io/%E8%AF%BB%E6%A0%87%E5%87%8601-ieee1451-%E6%99%BA%E8%83%BD%E4%BC%A0%E6%84%9F%E5%99%A8%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86%E4%BB%8B%E7%BB%8D/" data-title="【读标准01】IEEE1451 智能传感器接口标准介绍" data-ralateuid="u/3585238893"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/ieee-1451/">IEEE 1451</a>,&nbsp;<a href="/tags/%E6%A0%87%E5%87%86/">标准</a>,&nbsp;<a href="/tags/1451.0/">1451.0</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/%E4%B8%BB%E7%BA%BF%E5%89%A7%E6%83%8501-arm-imx6ull%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" class="prev" rel="prev" title="【主线剧情01】ARM IMX6ULL 基础学习记录"><i class="fas fa-angle-left fa-fw"></i>【主线剧情01】ARM IMX6ULL 基础学习记录</a>
            <a href="/%E5%BF%85%E5%85%88%E7%9C%8B%E4%B8%BB%E7%BA%BF%E5%89%A7%E6%83%85%E7%B3%BB%E5%88%97%E7%9A%84%E5%BE%AA%E5%BA%8F%E6%B8%90%E8%BF%9B%E7%9A%84%E6%9F%A5%E7%9C%8B%E9%A1%BA%E5%BA%8F/" class="next" rel="next" title="必先看：主线剧情系列的循序渐进的查看顺序">必先看：主线剧情系列的循序渐进的查看顺序<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.84.4">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021 - 2024</span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@7.0.4/dist/typeit.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{},"data":{"id-1":"回家","id-2":"回家"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
